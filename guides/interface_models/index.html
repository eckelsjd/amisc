
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Joshua Eckels">
      
      
        <link rel="canonical" href="https://eckelsjd.github.io/amisc/guides/interface_models/">
      
      
        <link rel="prev" href="../variables/">
      
      
        <link rel="next" href="../train_surrogate/">
      
      
      <link rel="icon" href="../../assets/amisc_logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Interface external models - Adaptive Multi-index Stochastic Collocation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 13h-4v4h-2v-4H7v-2h4V7h2v4h4m-5-9A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../styles/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-component-class" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Adaptive Multi-index Stochastic Collocation" class="md-header__button md-logo" aria-label="Adaptive Multi-index Stochastic Collocation" data-md-component="logo">
      
  <img src="../../assets/amisc_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Adaptive Multi-index Stochastic Collocation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Interface external models
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/eckelsjd/amisc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    eckelsjd/amisc
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../start/" class="md-tabs__link">
          
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../variables/" class="md-tabs__link">
          
  
    
  
  How-to Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/" class="md-tabs__link">
          
  
    
  
  API reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../theory/overview/" class="md-tabs__link">
          
  
    
  
  Theory

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Adaptive Multi-index Stochastic Collocation" class="md-nav__button md-logo" aria-label="Adaptive Multi-index Stochastic Collocation" data-md-component="logo">
      
  <img src="../../assets/amisc_logo.svg" alt="logo">

    </a>
    Adaptive Multi-index Stochastic Collocation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eckelsjd/amisc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    eckelsjd/amisc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../coverage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coverage report
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    How-to Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            How-to Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Interface external models
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Interface external models
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-component-class" class="md-nav__link">
    <span class="md-ellipsis">
      The Component class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-wrapper-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Python wrapper functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python wrapper functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#expected-format" class="md-nav__link">
    <span class="md-ellipsis">
      Expected format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calling-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Calling the model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special-model-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Special model arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special-model-return-values" class="md-nav__link">
    <span class="md-ellipsis">
      Special model return values
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-fidelities" class="md-nav__link">
    <span class="md-ellipsis">
      Model fidelities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storing-and-retrieving-training-data" class="md-nav__link">
    <span class="md-ellipsis">
      Storing and retrieving training data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specifying-a-surrogate-method" class="md-nav__link">
    <span class="md-ellipsis">
      Specifying a surrogate method
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parallelize-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Parallelize the model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-configuration-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Component configuration summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viewing-internal-data" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing internal data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Viewing internal data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index-sets" class="md-nav__link">
    <span class="md-ellipsis">
      Index sets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#misc-trees" class="md-nav__link">
    <span class="md-ellipsis">
      MISC trees
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overriding-the-data-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Overriding the data structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../train_surrogate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Train a surrogate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config_file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Write a config file
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extend amisc
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    API reference
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/component/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> component
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/compression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> compression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/distribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> distribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/interpolator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> interpolator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/serialize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> serialize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/training/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> training
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/transform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/typing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> typing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/variable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> variable
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/polynomials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lagrange polynomials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/feedback_cycles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feedback cycles
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-component-class" class="md-nav__link">
    <span class="md-ellipsis">
      The Component class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-wrapper-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Python wrapper functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python wrapper functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#expected-format" class="md-nav__link">
    <span class="md-ellipsis">
      Expected format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calling-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Calling the model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special-model-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Special model arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special-model-return-values" class="md-nav__link">
    <span class="md-ellipsis">
      Special model return values
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-fidelities" class="md-nav__link">
    <span class="md-ellipsis">
      Model fidelities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storing-and-retrieving-training-data" class="md-nav__link">
    <span class="md-ellipsis">
      Storing and retrieving training data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specifying-a-surrogate-method" class="md-nav__link">
    <span class="md-ellipsis">
      Specifying a surrogate method
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parallelize-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Parallelize the model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-configuration-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Component configuration summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viewing-internal-data" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing internal data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Viewing internal data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index-sets" class="md-nav__link">
    <span class="md-ellipsis">
      Index sets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#misc-trees" class="md-nav__link">
    <span class="md-ellipsis">
      MISC trees
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overriding-the-data-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Overriding the data structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Interface external models</h1>

<p>This guide will cover how to plug external models into the <code>amisc</code> framework using the <code>Component</code> class.</p>
<h2 id="the-component-class">The <code>Component</code> class</h2>
<p>The <code>Component</code> class is a black-box wrapper around a single discipline model. For example, if you had a system composed of a compressor, combuster, and turbine for modeling a turbojet engine, then each of the three disciplines would be wrapped in their own <code>Component</code> object. Just like the underlying model, a <code>Component</code> needs a callable function, a set of input variables, and a set of output variables:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">amisc</span> <span class="kn">import</span> <span class="n">Component</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">return</span> <span class="n">y</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">component</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">model</span>  <span class="o">=</span> <span class="n">model</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>                      <span class="n">inputs</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>                      <span class="n">outputs</span><span class="o">=</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p>For simple functions, the inputs and outputs can be inferred from the function signature:
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">):</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="n">y1</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">y2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="k">return</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">component</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">my_model</span><span class="p">)</span>  <span class="c1"># inputs and outputs are inferred</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="k">assert</span> <span class="n">component</span><span class="o">.</span><span class="n">inputs</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">]</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="k">assert</span> <span class="n">component</span><span class="o">.</span><span class="n">outputs</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">,</span> <span class="s1">&#39;y2&#39;</span><span class="p">]</span>
</span></code></pre></div></p>
<p>More generally, a list of strings or <code>Variable</code> objects can be passed as <code>Component(my_model, inputs=[...], outputs=[...])</code>. If the model needs extra configurations or arguments, they may be passed as keyword arguments:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">extra_config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="c1"># Etc.</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="k">return</span> <span class="n">outputs</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">component</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">extra_config</span><span class="o">=</span><span class="s1">&#39;My config value&#39;</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="python-wrapper-functions">Python wrapper functions</h2>
<p>The <code>Component.model</code> attribute is where the user can link their external model into the <code>amisc</code> framework; we call these "Python wrapper functions". The model must be written as a simple callable function in Python; however, it may make any external calls it needs to run simulation software that may exist outside of Python, i.e. such as a binary executable on the local machine. Several examples are provided in the <a href="../../tutorial/">tutorial</a> and <a href="../../examples/">elsewhere</a> in the documentation.</p>
<h3 id="expected-format">Expected format</h3>
<p>A wrapper function may be written in one of the two following formats:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="packed-inputsoutputs" name="__tabbed_1" type="radio" /><input id="unpacked-inputsoutputs" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="packed-inputsoutputs">Packed inputs/outputs</label><label for="unpacked-inputsoutputs">Unpacked inputs/outputs</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The function accepts a single <code>dict</code> positional argument, from which all variables may be accessed by key. Similarly, the model returns a single <code>dict</code> from which all output variables may be accessed by key.
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">input_dict</span><span class="p">):</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="n">x1</span> <span class="o">=</span> <span class="n">input_dict</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">input_dict</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">x3</span> <span class="o">=</span> <span class="n">input_dict</span><span class="p">[</span><span class="s1">&#39;x3&#39;</span><span class="p">]</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="c1"># Compute model</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="n">output_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;y2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    <span class="k">return</span> <span class="n">output_dict</span>
</span></code></pre></div></p>
<p>This format is the default and should typically be preferred (since you don't have to worry about variable ordering).</p>
</div>
<div class="tabbed-block">
<p>The function accepts several positional arguments, one for each input variable. Similarly, the model returns all output variables in a tuple. This format may be preferred as it makes the call and return signatures more explicit; however, you must keep track of the ordering of arguments and return values.
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">):</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="c1"># Compute model</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">y1</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="n">y2</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="k">return</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span>
</span></code></pre></div></p>
<p>This format is used when the inputs/outputs are inferred from the function signature (i.e. not provided directly to <code>Component()</code>). You may manually set the <code>Component(call_unpacked=True, ret_unpacked=True)</code> attributes if you prefer this format. Note that it is then up to you to keep track of ordering if you later decide to change the component's inputs or outputs.</p>
</div>
</div>
</div>
<p>It is also possible to accept "packed" inputs but return "unpacked" outputs, or vice versa by specifying the <code>call_unpacked</code> and <code>ret_unpacked</code> attributes of <code>Component</code>.</p>
<div class="admonition note">
<p class="admonition-title">Important note</p>
<p>We want to emphasize again that external models <strong>do not</strong> have to be written in Python to be used with <code>amisc</code>. The user needs only a basic familiarity with Python to write a wrapper function in one of the above formats. There are many built-in and third-party libraries that enable Python to integrate well with many external ecosystems (e.g. <code>juliacall</code> for Julia programs, <code>matlab.engine</code> for MATLAB, <code>PyAnsys</code> for ANSYS, <code>requests</code> for web-based resources, and the very general built-in <code>subprocess.run</code> for executing arbitrary code on the local machine.) The availability of these resources makes Python the ideal "glue" language for integrating models from a variety of platforms.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Using a global scope</p>
<p>Always specify the model at a <em>global</em> scope, i.e. don't use <code>lambda</code> or nested functions. When saving to
file, only a symbolic reference to the function signature will be saved, which must be globally defined (i.e. importable)
when loading back from that save file.</p>
</div>
<h3 id="calling-the-model">Calling the model</h3>
<p>Regardless of how you prefer to format your model wrapper function, the <code>Component</code> class provides a consistent interface for calling the model function through the <code>Component.call_model()</code> function. As shown in the <a href="../train_surrogate/">surrogate guide</a>, the surrogate <em>always</em> expects to be called in the "packed" format, i.e. by passing a <code>dict</code> whose keys are the input variables and whose values are the numeric values of those inputs (see the <a class="autorefs autorefs-internal" href="../../reference/typing/#amisc.typing.Dataset">Dataset</a> class). For example:
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span> <span class="nn">amisc</span> <span class="kn">import</span> <span class="n">Component</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="mf">5.5</span><span class="p">}</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="n">outputs_surr</span>  <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>                    <span class="c1"># prediction with the surrogate</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">outputs_model</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">call_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>                 <span class="c1"># prediction with the underlying model</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="n">outputs_model</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">use_model</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>  <span class="c1"># alias for call_model</span>
</span></code></pre></div>
As you can see, the <code>call_model</code> has the same signature as the <code>predict</code> function. We also provide the <code>use_model</code> alias within <code>predict</code> so that both surrogate and ground truth model predictions may be obtained using the exact same signature, regardless of how the wrapper function is written. The <code>call_model</code> interface also provides some convenience options for parallel and vectorized execution, which we cover later on <a href="#parallelize-the-model">in this guide</a>.</p>
<h3 id="special-model-arguments">Special model arguments</h3>
<p>Apart from providing a consistent interface for calling the model, the <code>call_model</code> function will also inspect your wrapper function for special keywords and pass extra data to your function as requested. There are 5 special keyword arguments that your wrapper function may request:</p>
<ul>
<li><code>model_fidelity</code> - will provide a set of fidelity indices to tune which physical fidelity of the model should be used (see the <a href="#model-fidelities">model fidelity</a> section for details),</li>
<li><code>input_vars</code> - will provide the actual <code>Variable</code> objects from <code>Component.inputs</code> in case your model needs extra details about the inputs,</li>
<li><code>output_vars</code> - will similarly provide the <code>Variable</code> objects from <code>Component.outputs</code>,</li>
<li><code>output_path</code> - will give your function a <code>Path</code> to a directory where it can write model outputs to file (e.g. if you have lots of extra save data you want to keep). This would be useful if you want to keep the context of each model evaluation with respect to the <code>amisc</code> surrogate, so that you might later construct a new surrogate for outputs you saved to file. This is similar to the <code>tmp_path</code> within the <code>pytest</code> framework.</li>
<li><code>{{ var }}_coords</code> - for a given "var" name, this will pass the compression grid coordinates for a given field quantity input variable.</li>
</ul>
<p>You may additionally pass any extra keyword arguments on to the model directly through <code>call_model(inputs, **kwargs)</code>.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">model_fidelity</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">output_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">input_vars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_coords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>                           <span class="c1"># get the input values for &#39;x&#39;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="k">if</span> <span class="n">x_coords</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>                      <span class="c1"># read compression grid coordinates for the &#39;x&#39; field quantity</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>        <span class="n">x_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>     <span class="c1"># default</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    <span class="n">delta_t</span> <span class="o">=</span> <span class="mf">1e-8</span> <span class="o">/</span> <span class="p">(</span><span class="n">model_fidelity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># set the time step based on model fidelity level</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">input_vars</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_nominal</span><span class="p">()</span>     <span class="c1"># set a threshold for x using info from the `Variable` objects</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>    <span class="c1"># Compute model</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="n">y</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>    <span class="k">if</span> <span class="n">output_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>               <span class="c1"># write outputs to file</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span> <span class="o">/</span> <span class="s1">&#39;my_outputs.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>            <span class="n">fd</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;y = </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;output_path&#39;</span><span class="p">:</span> <span class="s1">&#39;my_outputs.txt&#39;</span><span class="p">}</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">Variable</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nominal</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">outputs</span><span class="o">=</span><span class="n">Variable</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="n">pred</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">call_model</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span> <span class="n">model_fidelity</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">config</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;extra&#39;</span><span class="p">:</span> <span class="s1">&#39;configs&#39;</span><span class="p">})</span>
</span></code></pre></div>
</div>
<h3 id="special-model-return-values">Special model return values</h3>
<p>In addition to special keyword arguments, your wrapper function may also return special values. There are 4 values that may be returned by the wrapper function:</p>
<ul>
<li><code>{{ var }}</code> - for a given output "var" name -- these are just the usual numeric return values that match the variables in <code>Component.outputs</code>,</li>
<li><code>{{ var_coords }}</code> - for a given field quantity output "var" name -- these are the grid coordinates corresponding to the locations of the "var" output field quantity (returned shape is <span class="arithmatex">\((N, D)\)</span> where <span class="arithmatex">\(N\)</span> is the number of points and <span class="arithmatex">\(D\)</span> is the number of dimensions),</li>
<li><code>model_cost</code> - a best estimate for total model evaluation time (in seconds of CPU time). For example, if your model makes continuous use of 16 CPUs and takes 1 hour to evaluate one set of inputs, then you would return <code>16 * 3600</code> as the model cost. This metric is used by <code>amisc</code> to help evaluate which are the most "effective" model evaluations, i.e. more expensive models are penalized greater than cheaper models.</li>
<li><code>output_path</code> - if your function <em>requested</em> <code>output_path</code> and subsequently wrote some data to file, then you can <em>return</em> the new file name as <code>output_path</code> to keep track of the file's location within the <code>Component's</code> internal data storage.</li>
</ul>
<p>Your wrapper function may also return any extra data that you wish to store within the <code>Component</code> -- <code>amisc</code> will keep track of this data but will not use it for any purpose. You might do this if you wish to return to old model evaluations later on and view data even if you did not explicitly build a surrogate for the data. This extra data will be stored in <code>numpy</code> object arrays, so the data does not have to be strictly numeric type -- it could even be custom object types of your own. Field quantities will also be stored in <code>numpy</code> object arrays.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>    <span class="c1"># time the model evaluation</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="c1"># Compute the model</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="n">y1</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="n">y2</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>    <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>    <span class="k">if</span> <span class="n">output_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span> <span class="o">/</span> <span class="s1">&#39;my_output.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>            <span class="n">fd</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;I want to store some output data via file here&#39;</span><span class="p">)</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>    <span class="n">extra_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;store&#39;</span><span class="p">:</span> <span class="s1">&#39;extra&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;here&#39;</span><span class="p">}</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;y1&#39;</span><span class="p">:</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;y2&#39;</span><span class="p">:</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;model_cost&#39;</span><span class="p">:</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span><span class="p">,</span> <span class="s1">&#39;output_path&#39;</span><span class="p">:</span> <span class="s1">&#39;my_output.txt&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_data</span><span class="p">}</span>
</span></code></pre></div>
</div>
<h2 id="model-fidelities">Model fidelities</h2>
<p>As we saw in the <a href="#special-model-arguments">special arguments</a> section, your wrapper function may request the <code>model_fidelity</code> keyword argument. This will pass a tuple of integers (what we call a <em>multi-index</em>) to your function, for which you can use to "tune" the fidelity level of your model. For example, if you build a <code>Component</code> and specify a tuple of two integers: <code>Component(..., model_fidelity=(3, 2))</code>, then the "maximum" fidelity of your model is fully specified by the numbers <span class="arithmatex">\((3, 2)\)</span>. You can use these integers however you want to adjust model fidelity, e.g. <code>num_grid_pts = 100 * (model_fidelity[0] + 1)</code> would use the first integer to tune how many grid points are used in a simulation, with higher integers corresponding to more grid points, and therefore higher numerical accuracy. Your wrapper function should then request <code>model_fidelity</code> and use the multi-index as desired:
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">model_fidelity</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    <span class="n">num_grid_pts</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">model_fidelity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>      <span class="c1"># controls number of grid points</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>    <span class="n">time_step</span> <span class="o">=</span> <span class="mf">1e-8</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">model_fidelity</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># controls time step size</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="c1"># etc.</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>    <span class="k">return</span> <span class="n">outputs</span>
</span></code></pre></div>
During surrogate training, your wrapper function will then be passed tuples of varying model fidelity (from <span class="arithmatex">\((0, 0)\)</span> up to <span class="arithmatex">\((3, 2)\)</span> in the example). If you do not request <code>model_fidelity</code>, then your wrapper function will not be passed any fidelity indices, and will instead be treated as a single fidelity model.</p>
<p>Apart from <code>model_fidelity</code>, you may also specify similar tuples of integers for <code>data_fidelity</code> and <code>surrogate_fidelity</code>, which correspond to fidelity levels for training data and the surrogate method, respectively. These indices are used internally by <code>amisc</code> during training and are not passed to your wrapper function like <code>model_fidelity</code>. Instead, together they tune the amount of training data collected and the refinement level of the surrogate method (e.g. number of hidden layers, weights, etc.) As such, their usage is dependent on the specific underlying methods for training data collection and surrogate evaluation.</p>
<p>The <a href="../../tutorial/">tutorial</a> provides more detail on how to interpret and use model fidelities. For the purposes of this guide, we summarize the fidelity options for the <code>Component</code> class in the example below:
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">model_fidelity</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>       <span class="c1"># the maximum model fidelity indices</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>                      <span class="n">data_fidelity</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>     <span class="c1"># the maximum training data fidelity indices</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>                      <span class="n">surrogate_fidelity</span><span class="o">=</span><span class="p">())</span>       <span class="c1"># the maximum surrogate fidelity indices</span>
</span></code></pre></div></p>
<p>By default, the only training data method available is the <code>SparseGrid</code> -- the sparse grid method uses one index in <code>data_fidelity</code> per input, so that <code>len(data_fidelity) == len(inputs)</code>. Each index determines the maximum training data allowed along each input dimension. For a <code>data_fidelity</code> of <span class="arithmatex">\(\beta\)</span> for example, each input <span class="arithmatex">\(x_i\)</span> for <span class="arithmatex">\(i=0\dots N\)</span> has a maximum number of training points of <span class="arithmatex">\(2\beta_i + 1\)</span>, which for <span class="arithmatex">\(\beta = (2, 3, 1)\)</span> means a max grid size of <span class="arithmatex">\((4, 7, 3)\)</span>. These options are configurable, and more information can be found at <a class="autorefs autorefs-internal" href="../../reference/training/#amisc.training.SparseGrid">SparseGrid</a>.</p>
<p>By default, the only surrogate method available is the <code>Lagrange</code> -- Lagrange polynomial interpolation does not use any method for tuning its own fidelity, so <code>surrogate_fidelity</code> may be left empty. See more details at <a class="autorefs autorefs-internal" href="../../reference/interpolator/#amisc.interpolator.Lagrange">Lagrange</a>.</p>
<p>We frequently refer to <code>model_fidelity</code> by the symbol "<span class="arithmatex">\(\alpha\)</span>", and to the combination of <code>data_fidelity</code> and <code>surrogate_fidelity</code> as "<span class="arithmatex">\(\beta\)</span>". For a given pair of <span class="arithmatex">\((\alpha, \beta)\)</span>, the <code>Component</code> surrogate can be trained by "activating" the index pair via:
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">model_fidelity</span><span class="o">=...</span><span class="p">,</span> <span class="n">data_fidelity</span><span class="o">=...</span><span class="p">,</span> <span class="n">surrogate_fidelity</span><span class="o">=...</span><span class="p">)</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>      <span class="c1"># for example</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">comp</span><span class="o">.</span><span class="n">activate_index</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>  <span class="c1"># &#39;train&#39; the surrogate for this index pair</span>
</span></code></pre></div></p>
<p>By calling <code>activate_index</code>, we will move <span class="arithmatex">\((\alpha, \beta)\)</span> into the component's "active" index set, and then search for and compute model evaluations for all the "neighboring" index pairs. For most users, this will be done automatically on a call to <code>System.fit()</code>, but we provide this description here for completeness. To get a better understanding of "active" and "neighboring" index sets, please see the <a href="../../theory/overview/">theory</a> section.</p>
<h2 id="storing-and-retrieving-training-data">Storing and retrieving training data</h2>
<p>The <code>Component.training_data</code> attribute provides the method by which training data is sampled (i.e. experimental design), stored, and retrieved. Currently, the only available method is the <a class="autorefs autorefs-internal" href="../../reference/training/#amisc.training.SparseGrid">SparseGrid</a>, which is set by default. For the most part, all aspects of training data manipulation is handled behind the scenes by the <code>Component</code> class. You may configure the training data method via:
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">from</span> <span class="nn">amisc.training</span> <span class="kn">import</span> <span class="n">SparseGrid</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">training_data</span><span class="o">=</span><span class="n">SparseGrid</span><span class="p">(</span><span class="n">collocation_rule</span><span class="o">=</span><span class="s1">&#39;leja&#39;</span><span class="p">))</span>
</span></code></pre></div></p>
<p>New training data methods may be created by implementing the <code>amisc.training.TrainingData</code> interface. Data storage and retrieval is generally guided by the <span class="arithmatex">\((\alpha, \beta)\)</span> fidelity indices described in the <a href="#model-fidelities">fidelity</a> section. The <code>Component</code> class provides the <code>get_training_data</code> method to extract all input/output data associated with a given <span class="arithmatex">\((\alpha, \beta)\)</span> pair:
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>      <span class="c1"># for example</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">xtrain</span><span class="p">,</span> <span class="n">ytrain</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">get_training_data</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
</span></code></pre></div></p>
<p>By default <code>get_training_data</code> will return the training data associated with the highest-fidelity pair of <span class="arithmatex">\((\alpha, \beta)\)</span>. After fitting a surrogate, the user may wish to extract the training data for each fidelity level and attempt construction of other surrogates to compare performance; this is made possible by the <code>get_training_data</code> interface.</p>
<p>As one last note, if your model returns field quantity data, this will be stored along with its compressed latent space representation. By default, both representations of the field quantity are returned by <code>get_training_data</code>.</p>
<h2 id="specifying-a-surrogate-method">Specifying a surrogate method</h2>
<p>The <code>Component.interpolator</code> attribute provides the underlying surrogate "interpolation" method, i.e. the specific mathematical relationship that approximates the model's outputs as a function of its inputs. In this sense, we use the terms "interpolator" and "surrogate" interchangeably to mean the underlying approximation method -- the <code>Component.interpolator</code> does not necessarily have to "interpolate" the output by passing through all the training data directly. The naming convention mostly arises from the usage of polynomial interpolation in sparse grids.</p>
<p>Currently, the only available interpolation method is the <a class="autorefs autorefs-internal" href="../../reference/interpolator/#amisc.interpolator.Lagrange">Lagrange</a> polynomial interpolation, which is set by default. Multivariate Lagrange polynomials are formed by a tensor-product of univariate Lagrange polynomials in each input dimension, and integrate well with the <code>SparseGrid</code> data structure. Lagrange polynomials work well up to an input dimension of around 12-15 for sufficiently smooth functions. More details on how they work can be found in the <a href="../../theory/polynomials/">theory</a> section.</p>
<p>You may configure the interpolation method via:
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">from</span> <span class="nn">amisc.interpolator</span> <span class="kn">import</span> <span class="n">Lagrange</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">interpolator</span><span class="o">=</span><span class="n">Lagrange</span><span class="p">())</span>
</span></code></pre></div></p>
<p>New interpolation/surrogate methods may be created by implementing the <code>amisc.interpolator.Interpolator</code> interface.</p>
<h2 id="parallelize-the-model">Parallelize the model</h2>
<p>A large advantage of the <code>Component.call_model()</code> interface is the ability to evaluate multiple input samples with the model in parallel. If your model wrapper function only processes one set of inputs at a time (i.e. only single values in the <code>inputs</code> dictionary), then calling the model through <code>call_model</code> will automatically allow handling arrays of inputs. For example:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="single-input" name="__tabbed_2" type="radio" /><input id="arrayed-inputs" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="single-input">Single input</label><label for="arrayed-inputs">Arrayed inputs</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>    <span class="n">x1</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span>       <span class="c1"># single float</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span>       <span class="c1"># single float</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;y1&#39;</span><span class="p">:</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span><span class="p">}</span>  <span class="c1"># single float</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="n">output</span> <span class="o">=</span> <span class="n">my_model</span><span class="p">({</span> <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="mf">1.5</span> <span class="p">})</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="c1"># will give { &#39;y1&#39;: 0.75 }</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>    <span class="n">x1</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span>       <span class="c1"># single float</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span>       <span class="c1"># single float</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;y1&#39;</span><span class="p">:</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span><span class="p">}</span>  <span class="c1"># single float</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">],</span> <span class="s1">&#39;y1&#39;</span><span class="p">)</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="n">output</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">call_model</span><span class="p">({</span> <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">})</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="c1"># will give { &#39;y1&#39;: np.array(shape=100) }</span>
</span></code></pre></div>
</div>
</div>
</div>
<p>By default, this will run the input samples in a serial loop, which will not provide any speedup, but does allow your single-input wrapper function to be used with arrays of inputs.</p>
<p>To parallelize the model over the input arrays, you may pass an instance of an <code>Executor</code> to <code>call_model</code> (i.e. something that implements the built-in Python <code>concurrent.futures.Executor</code> interface -- Python itself provides the <code>ProcessPoolExecutor</code> and <code>ThreadPoolExecutor</code> which use parallel process- or thread-based workers). The popular <code>mpi4py</code> library also provides an <code>MPIExecutor</code> to distribute parallel tasks over <abbr title="Message Passing Interface">MPI</abbr>-enabled workers. You may similarly pass an instance of <code>Executor</code> to any functions where you wish to parallelize model evaluations (such as <code>System.fit()</code> for training the surrogate).</p>
<p>Finally, if your wrapper function can handle arrayed inputs on its own, then you may set <code>Component.vectorized=True</code>. Input dictionaries will then be passed to your wrapper function with <code>np.ndarrays</code> as values for each input variable rather than scalar <code>floats</code>. For example, you can take advantage of <code>numpy</code> vectorization to directly manipulate two arrays of inputs rather than looping over each element (e.g. <code>y = x1 * x2</code> rather than <code>y = [x1[i] * x2[i] for i in range(N)]</code>).</p>
<p>If you do use <code>vectorized=True</code> and you're also using <code>model_fidelity</code>, you should expect <code>model_fidelity</code> as an <code>np.ndarray</code> of shape <code>(N, R)</code>, where <code>N</code> is the loop shape of the inputs and <code>R</code> is the number of fidelity indices; usually you would just expect a tuple of length <code>R</code> when <code>vectorized=False</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="serial" name="__tabbed_3" type="radio" /><input id="parallel" name="__tabbed_3" type="radio" /><input id="vectorized" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="serial">Serial</label><label for="parallel">Parallel</label><label for="vectorized">Vectorized</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>    <span class="n">x1</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span>   <span class="c1"># float</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span>   <span class="c1"># float</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>    <span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;y1&#39;</span><span class="p">:</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span> <span class="p">}</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">],</span> <span class="s1">&#39;y1&#39;</span><span class="p">)</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="ow">in</span>  <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">}</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="n">out</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">call_model</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>    <span class="n">x1</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span>   <span class="c1"># float</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span>   <span class="c1"># float</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>    <span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;y1&#39;</span><span class="p">:</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span> <span class="p">}</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">],</span> <span class="s1">&#39;y1&#39;</span><span class="p">)</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="ow">in</span>  <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">}</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">call_model</span><span class="p">(</span><span class="ow">in</span><span class="p">,</span> <span class="n">executor</span><span class="o">=</span><span class="n">executor</span><span class="p">)</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>    <span class="n">x1</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span>   <span class="c1"># np.ndarray (100,)</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span>   <span class="c1"># np.ndarray (100,)</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    <span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;y1&#39;</span><span class="p">:</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span> <span class="p">}</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">my_model</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">],</span> <span class="s1">&#39;y1&#39;</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="ow">in</span>  <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">}</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="n">out</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">call_model</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span>
</span></code></pre></div>
</div>
</div>
</div>
<p>Generally, the surrogate predictions (e.g. <code>Component.predict</code>) make use of <code>numpy</code> vectorization to handle arrayed inputs, so <code>call_model</code> again acts as a consistent interface for calling the underlying model with the same signature as the surrogate.</p>
<div class="admonition note">
<p class="admonition-title">Loop dimensions</p>
<p>If you pass a scalar input array of arbitrary shape (say <span class="arithmatex">\((100, 2, 5)\)</span> for example), <code>Component.call_model()</code> treats all axes in the array as "loop dimensions". So effectively, all the axes will be flattened to a single 1d array of length <code>N = np.prod(input.shape)</code>, which would be <span class="arithmatex">\(N=1000\)</span> for an input shape of <span class="arithmatex">\((100, 2, 5)\)</span>. Then, <code>call_model</code> will loop over <span class="arithmatex">\(N\)</span>, passing each input sample to the underlying model (unless <code>vectorized=True</code>). The outputs will be reshaped back to the original input "loop" shape before returning. If you do pass an input array for one variable, you should pass the same shape array for all other inputs, or at least an array that is broadcastable to the full loop shape. See <a href="https://numpy.org/doc/stable/user/basics.broadcasting.html"><code>numpy</code> broadcasting</a> rules.</p>
<p>The situation is a bit more complicated for non-scalar inputs (i.e. field quantities). You may still pass arrays of field quantities as inputs, so that they are looped over in the same fashion as scalar inputs. However, which axes are a "loop shape" vs. what axes are part of the field quantity's shape itself must be inferred or indicated. Generally, as long as you provide at least one scalar input, then the loop shape is known and the first leading axes of the field quantity that match the loop shape will be used as such, while the rest are assumed to be the field quantity's own shape. For example:
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>      <span class="c1"># scalar</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># field quantity with shape (20,)</span>
</span></code></pre></div></p>
<p>Clearly, the loop shape is (100, 2) and we can infer the field quantity shape of (20,). If the field quantity were provided by itself, then you should also provide <code>f_coords</code> to <code>call_model()</code> so that the field quantity shape for the <code>f</code> variable can be obtained from the shape of its grid coordinates. See the <a href="../variables/">field quantity</a> documentation for more details.</p>
</div>
<h2 id="component-configuration-summary"><code>Component</code> configuration summary</h2>
<p>Here is a summary of all configurations that may be passed to <code>Component</code> by example:
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">def</span> <span class="nf">my_model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">model_fidelity</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">**</span><span class="n">extra_kwargs</span><span class="p">):</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>    <span class="n">x1</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>    <span class="n">x3</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x3&#39;</span><span class="p">]</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;y1&#39;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;y2&#39;</span><span class="p">:</span> <span class="o">...</span><span class="p">}</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">,</span>                <span class="c1"># The Python wrapper function of the component model</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>                 <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">],</span>     <span class="c1"># List of input variables (str or Variable objects)</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>                 <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">,</span> <span class="s1">&#39;y2&#39;</span><span class="p">],</span>          <span class="c1"># List of output variables (str or Variable objects)</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>                 <span class="n">model_fidelity</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>         <span class="c1"># Physical model fidelity multi-index</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>                 <span class="n">data_fidelity</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>       <span class="c1"># Data fidelity multi-index (length matches len(inputs) for SparseGrid)</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>                 <span class="n">surrogate_fidelity</span><span class="o">=</span><span class="p">(),</span>         <span class="c1"># Surrogate fidelity multi-index (empty for Lagrange)</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>                 <span class="n">training_data</span><span class="o">=</span><span class="n">SparseGrid</span><span class="p">(),</span>    <span class="c1"># Collocation/design and storage method for training data</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>                 <span class="n">interpolator</span><span class="o">=</span><span class="n">Lagrange</span><span class="p">(),</span>       <span class="c1"># Underlying surrogate/interpolation method</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>                 <span class="n">vectorized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>               <span class="c1"># If wrapper function handles arrayed inputs</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>                 <span class="n">call_unpacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>           <span class="c1"># Call signature of   `func(x1, x2, ...)`  if True</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>                 <span class="n">ret_unpacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>            <span class="c1"># Return signature of `return y1, y2, ...` if True</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;My component&#39;</span><span class="p">,</span>           <span class="c1"># ID for log messages and referencing</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>                 <span class="o">**</span><span class="n">extra_kwargs</span><span class="p">)</span>                <span class="c1"># Extra keyword arguments to pass to wrapper function</span>
</span></code></pre></div></p>
<p>A few important things to keep in mind:</p>
<ul>
<li>The first three arguments (<code>model</code>, <code>inputs</code>, <code>outputs</code>) must always be specified (or at least inferred for inputs/outputs) and can be passed as positional arguments.</li>
<li>If all of the <code>fidelity</code> options are left empty, then no surrogate will be built.</li>
<li>The wrapper function must request <code>model_fidelity</code> as a keyword argument if you specify it in the <code>Component</code>.</li>
<li>Data and surrogate fidelity usage are dependent on <code>training_data</code> and <code>interpolator</code>, respectively. The length of <code>data_fidelity</code> should match the number of inputs for <code>SparseGrid</code> training data.</li>
<li>Setting <code>vectorized=True</code> means the wrapper function should handle arrayed inputs (as well as arrayed <code>model_fidelity</code> if applicable).</li>
<li>The "packed" call and return signatures are preferred (i.e. the default is <code>call_unpacked=False</code> and <code>ret_unpacked=False</code>) -- the wrapper function should receive and return dictionaries, where the keys are the variables with their corresponding values.</li>
<li>The wrapper function should additionally return the special variables <code>{{ var }}_coords</code> to provide the grid coordinates for field quantity outputs.</li>
</ul>
<h2 id="viewing-internal-data">Viewing internal data</h2>
<p>There are a few use cases for wanting to manipulate the internal data structures of a <code>Component</code>, so for completeness, we summarize the data structures here. Components store data with respect to the <span class="arithmatex">\((\alpha, \beta)\)</span> fidelity indices; see the <a href="#model-fidelities">model fidelity</a> section for more details.</p>
<h3 id="index-sets">Index sets</h3>
<p>An index set is a set of concatenated multi-indices <span class="arithmatex">\((\alpha, \beta)\)</span>. For example, <span class="arithmatex">\(\mathcal{I}=\{ ((0,), (0,)), ((0,), (1,)), ((1,), (0,)), ((1,), (1,)) \}\)</span> is the set of all combinations of <span class="arithmatex">\(\alpha\)</span> and <span class="arithmatex">\(\beta\)</span> ranging from 0 to 1.</p>
<p>A <code>Component</code> has two index sets: an <code>active_set</code> and a <code>candidate_set</code>. The active set is the set of fidelity levels that are currently being used in the surrogate approximation. The candidate set is all fidelity levels that are forward neighbors of the active set, e.g. <span class="arithmatex">\((1, 0)\)</span> and <span class="arithmatex">\((0, 1)\)</span> are forward neighbors of <span class="arithmatex">\((0, 0)\)</span>. While training the surrogate, only the active set is used for prediction. After training, both active and candidate sets are used together for prediction.</p>
<h3 id="misc-trees"><abbr title="Multi-Index Stochastic Collocation">MISC</abbr> trees</h3>
<p>For every <span class="arithmatex">\((\alpha, \beta)\)</span> multi-index pair, the component stores four items in a tree-like structure:</p>
<ul>
<li><em>interpolator state</em> - the state of the underlying interpolator (e.g. weights, biases, coefficients, etc.). Since a single <span class="arithmatex">\((\alpha, \beta)\)</span> pair corresponds to a single set of training data, the interpolator state is the corresponding surrogate trained on this data.</li>
<li><em>cost</em> - the computational expense incurred by adding <span class="arithmatex">\((\alpha, \beta)\)</span> to the surrogate approximation, i.e. the cost of evaluating the model on the new training data.</li>
<li><em>train coefficients</em> - the combination technique coefficients for the <span class="arithmatex">\((\alpha, \beta)\)</span> surrogate under the active index set (see <a href="../../theory/overview/">theory</a> for more details).</li>
<li><em>test coefficients</em> - the combination technique coefficients for the <span class="arithmatex">\((\alpha, \beta)\)</span> surrogate under both the active and candidate index sets (see <a href="../../theory/overview/">theory</a> for more details).</li>
</ul>
<p>Additionally, the computational expense (seconds of CPU time for one evaluation) of each <span class="arithmatex">\(\alpha\)</span> fidelity level is stored. The internal data structures of the <code>Component</code> are summarized below:
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">comp</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="o">...</span><span class="p">,</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>                 <span class="n">active_set</span><span class="o">=</span><span class="n">IndexSet</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>          <span class="c1"># &quot;active&quot; index set during training</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>                 <span class="n">candidate_set</span><span class="o">=</span><span class="n">IndexSet</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>       <span class="c1"># &quot;candidate&quot; index set (forward neighbors of the active set)</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>                 <span class="n">misc_states</span><span class="o">=</span><span class="n">MiscTree</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>         <span class="c1"># interpolator states (weights, biases, etc.)</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>                 <span class="n">misc_costs</span><span class="o">=</span><span class="n">MiscTree</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>          <span class="c1"># cost incurred to add each multi-index pair</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>                 <span class="n">misc_coeff_train</span><span class="o">=</span><span class="n">MiscTree</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>    <span class="c1"># combination technique coeffs (active)</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>                 <span class="n">misc_coeff_test</span><span class="o">=</span><span class="n">MiscTree</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>     <span class="c1"># combination technique coeffs (active+candidate)</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>                 <span class="n">model_costs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>             <span class="c1"># computational expense of each model fidelity level</span>
</span></code></pre></div></p>
<h3 id="overriding-the-data-structures">Overriding the data structures</h3>
<p>All of the <code>Component</code> data structures are managed internally and do not need to be set by the user. However, the <code>Component.predict()</code> function accepts an <code>index_set</code> and a <code>misc_coeff</code> argument so that the user may predict with the surrogate using an alternate set of training data. In this case, the user would maintain their own <code>IndexSet</code> and <code>MiscTree</code> structures outside the <code>Component</code> and pass them as <code>Component.predict(..., index_set=index_set, misc_coeff=misc_coeff)</code>.</p>
<p>For example, during surrogate training via <code>System.fit()</code>, the component surrogate is called with a modified index set while adaptively searching for the next best <span class="arithmatex">\((\alpha, \beta)\)</span> pair to add to the surrogate approximation. See the <a class="autorefs autorefs-internal" href="../../reference/system/#amisc.system.System.refine">System.refine</a> documentation.</p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-12-03T03:03:31+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-12-03</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-11-04T22:10:15+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-11-04</span>
  </span>

    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="Contributors">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/eckelsjd" class="md-author" title="@eckelsjd">
          
          <img src="https://avatars.githubusercontent.com/u/33996464?v=4&size=72" alt="eckelsjd">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../variables/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Use variables">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Use variables
              </div>
            </div>
          </a>
        
        
          
          <a href="../train_surrogate/" class="md-footer__link md-footer__link--next" aria-label="Next: Train a surrogate">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Train a surrogate
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy 2024 Joshua Eckels
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/eckelsjd" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/amisc/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.instant", "navigation.tabs", "navigation.sections", "navigation.indexes", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
      
        <script src="../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../javascript/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>